<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content='IE=edge;chrome=1'/> <meta name=viewport content="width=device-width, initial-scale=1"> <script>addEventListener('error', window.__e=function f(e){f.q=f.q||[];f.q.push(e)});</script> <link rel=canonical href=https://kevinjalbert.com/editing-with-pry/> <title>Editing with Pry | Kevin Jalbert</title> <meta name=description content="Learn to edit within a pry session. Experience the power of multi-line and patch editing."/> <meta name=keywords content="tools, ruby, pry"/> <meta name=datePublished content="2018-03-23 00:00:00 UTC"/> <meta property="og:article:published_time" content="2018-03-23 00:00:00 UTC"/> <meta name=author content="Kevin Jalbert"/> <meta property="og:article:author" content="2018-03-23 00:00:00 UTC"/> <meta name=url content="https://kevinjalbert.com/editing-with-pry/"/> <meta property="og:url" content="https://kevinjalbert.com/editing-with-pry/"/> <meta name=site content="Kevin Jalbert"/> <meta property="og:site_name" content="Kevin Jalbert"/> <meta name="twitter:card" content=summary_large_image /> <meta name="twitter:creator" content="@kevinjalbert"/> <meta name="twitter:description" content="Learn to edit within a pry session. Experience the power of multi-line and patch editing."/> <meta name="twitter:image:src" content="https://kevinjalbert.com/images/2018-03-23-editing-with-pry/prybar-brush.jpg"/> <meta name="twitter:site" content="Kevin Jalbert"/> <meta name="twitter:title" content="Editing with Pry"/> <meta property="og:description" content="Learn to edit within a pry session. Experience the power of multi-line and patch editing."/> <meta property="og:image" content="https://kevinjalbert.com/images/2018-03-23-editing-with-pry/prybar-brush.jpg"/> <meta property="og:title" content="Editing with Pry"/> <script type="application/ld+json">
    {
       "@context": "http://schema.org",
       "@type": "BlogPosting",
       "headline": "Editing with Pry",
       "keywords": "tools, ruby, pry",
       "url": "https://kevinjalbert.com/editing-with-pry/",
       "datePublished": "2018-03-23 00:00:00 UTC",
       "dateModified": "2018-03-23 00:00:00 UTC",
       "author": {
         "@type": "Person",
         "name": "Kevin Jalbert",
         "sameAs": [
           "https://twitter.com/kevinjalbert",
           "https://github.com/kevinjalbert",
           "https://keybase.io/kevinjalbert",
           "https://reddit.com/user/kevinjalbert"
         ]
       },
       "mainEntityOfPage": {
          "@type": "WebPage",
         "@id": "https://kevinjalbert.com/editing-with-pry/"
       }
    }
  </script> <link href="/stylesheets/app.css" rel=stylesheet /> <link rel=alternate type="application/atom+xml" title="Articles | Kevin Jalbert" href="/feed.xml"/> <script async src="/vendor/analytics/index.js"></script> <script async src="https://www.google-analytics.com/analytics.js"></script> </head> <div class=container> <div class=header> <div class="col-xs-12 col-sm-7 navigation"> <a class=banner href="/">Kevin Jalbert</a> <a href="/about/">About</a> <a href="/now/">Now</a> <a href="/uses/">Uses</a> <a href="https://github.com/kevinjalbert/ama/blob/master/README.md">AMA</a> </div> <div class="col-xs-12 col-sm-5 search-component"> <input placeholder=Search class="search ui-autocomplete-input ui-corner-all" autocomplete=on> </div> </div> </div> <body> <div class="container content article"> <div class=row> <div class=col-md-12> <h1 class=article__title><p>Editing with Pry</p> </h1> <div class="row article__meta-info"> <div class="col-xs-4 col-md-4"> <div class="article__date entry-date">March 23, 2018 </div> </div> <div class="col-xs-4 col-md-4"> <div class=article__read-time>2 min read</div> </div> <div class="col-xs-4 col-md-4"> <div class=article__comments> <a href="https://kevinjalbert.com/editing-with-pry/#disqus_thread">0 Comments</a> </div> </div> </div> <div class="row article__meta-tags"> <div class="col-xs-12 col-md-12"> <div class=article__tags> <a href="/tags/pry/">pry</a> <a href="/tags/ruby/">ruby</a> <a href="/tags/tools/">tools</a> </div> </div> </div> <img src=/images/2018-03-23-editing-with-pry/prybar-brush.jpg> <i><p><a href="https://flickr.com/photos/evilpics/16088956283" title="Pry Bar &amp; Wire Brush">Pry Bar &amp; Wire Brush</a> by <a href="https://flickr.com/people/evilpics">Scott Hart</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">CC BY-NC-ND</a></p> </i> <div class=article__separator></div> <p>I&rsquo;ve already touched a bit on the power of <code>pry</code> in a <a href="/lets-pry-into-ruby-objects/">previous post back in 2016</a>. I want to revisit <code>pry</code> to expand on a new functionality that I have since started using &ndash; its ability to edit.</p> <h2>More than One Line?</h2> <p>In my personal experiences, I&rsquo;ve constructed some <em>long</em> one-liners while in <code>irb</code> or <code>pry</code>. These interactive sessions do not provide a great experience for multi line commands, as you are restricted to editing only one line at a time.</p> <p>Fortunately, in <code>pry</code>, there is the <code>edit</code> method. This opens up a temporary file (<code>pry</code>&rsquo;s input buffer) with a more capable editor for your task. You can configure the editor by executing the <code>Pry.config.editor = &quot;vim&quot;</code> statement, although your environment variable <code>EDITOR</code> is used by default. If you want, you can even use a GUI editor like <a href="https://atom.io/">Atom</a> (you&rsquo;ll need to use <code>atom --wait</code> for this to work). If you have a specific preference, it makes sense to add this configuration in your <code>.pryrc</code> so it is configured when <code>pry</code> loads up.</p> <p>By default, <code>edit</code> will open the last executed statement issued in your session. If you want to edit with a blank canvas, then you can use the <code>edit -t</code> to open a temporary buffer. You can even get fancy and re-edit older inputs using <code>edit --in &lt;input-number&gt;</code> (i.e., <code>edit --in -2</code> &ndash; the second last input).</p> <p>Using a full editor is great for those more complex statements. Now you can break up statements into multiple lines to make it easier to comprehend and create. In the event you were <em>slightly</em> wrong, you can simply <code>edit</code> again and fix up your statement. This is great for iteratively building longer statements. It is a common style in Ruby to use indentation when using blocks and defining classes/methods/modules, so take advantage of <code>edit</code>.</p> <p>The following demonstrates <code>pry</code>&rsquo;s multi-line editing functionality.</p> <script src="https://asciinema.org/a/KjOsTASz7MMzrJV2lSxi6SWdM.js" id=asciicast-KjOsTASz7MMzrJV2lSxi6SWdM async></script> <h2>Patching Objects</h2> <p>The <code>edit</code> method has one more amazing trick up its sleeve &ndash; <em>patch editing</em>. <code>pry</code> now gives you the ability to modify existing object method definitions at runtime. To quote the help text for the <code>edit --patch</code>:</p> <blockquote> <p><em>Instead of editing the object&rsquo;s file, try to edit in a tempfile and apply as a monkey patch</em></p> </blockquote> <p>As the patch is only for the <code>pry</code> session, there is a greater sense of exploring and less worry surrounding the commitment of the edit.</p> <p>Some caveats that I&rsquo;ve hit with this approach is that you can only patch <code>&lt;class&gt;#&lt;method&gt;</code> (instance method) or <code>&lt;class&gt;.&lt;method&gt;</code> (class method). You might want to edit the class itself, but you&rsquo;ll hit <code>NotImplementedError: Cannot yet patch #&lt;Pry::WrappedModule:0x007fcc32afecd0&gt; objects!</code>. Unfortunately, I&rsquo;ve not yet found a nice way to get around this (so let me know if you have a way!). I know that you can modify the file itself (i.e., <code>edit app/models/model.rb</code>) but that&rsquo;ll actually write to the file &ndash; I would want it done as a patch.</p> <p>The following demonstrates <code>pry</code>&rsquo;s patch editing functionality.</p> <script src="https://asciinema.org/a/0zvuYLvnQXHkZ9DpFZl4l3Sxe.js" id=asciicast-0zvuYLvnQXHkZ9DpFZl4l3Sxe async></script> <div class=newsletter__form> <div class="panel panel-default"> <div class=panel-heading> <h4 class="panel-title accordion-toggle collapsed" data-toggle=collapse data-parent="#accordion" href="#newsletterFormCollapse"> Signup for my Newsletter </h4> </div> <div id=newsletterFormCollapse class="panel-collapse collapse"> <div class=panel-body> <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel=stylesheet> <style>
              #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
              /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
                 We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
        </style> <div id=mc_embed_signup> <form action="//kevinjalbert.us14.list-manage.com/subscribe/post?u=fe02783eec556cfc2893fe174&amp;id=aecd14f8e6" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate> <div id=mc_embed_signup_scroll> <input type=email value="" name=EMAIL class=email id=mce-EMAIL placeholder="email address" required> <div style="position: absolute; left: -5000px;" aria-hidden=true><input name=b_fe02783eec556cfc2893fe174_aecd14f8e6 tabindex=-1 value=""></div> <div class=clear><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class=button></div> </div> </form> </div> </div> </div> </div> </div> <div class=article__comments-button><button type=button class="btn btn-default show-comments">Click to Disqus</button></div> <div id=disqus_thread></div> </div> </div> </div> <script>
//<![CDATA[
    var disqus_shortname = 'kevinjalbert';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
//]]>
</script> </body> <div class="container footer"> <div class="col-md-12 footer__social"> <a href="https://twitter.com/KevinJalbert">Twitter</a> <a href="https://github.com/kevinjalbert">GitHub</a> <a href="https://stackoverflow.com/users/583592/kevin-jalbert">Stack Overflow</a> </div> <div class="col-md-12 footer__copywrite"> Code licensed <a href="https://github.com/kevinjalbert/kevinjalbert.github.io/blob/real-master/LICENSE">MIT</a>, Content &copy; 2019 Kevin Jalbert </div> </div> </html> <script src="/javascripts/app.js"></script> <div id=amzn-assoc-ad-36830a7e-7ad1-4cf6-983b-8b5b373a62c0></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=36830a7e-7ad1-4cf6-983b-8b5b373a62c0"></script>