<!DOCTYPE html> <html lang=en> <head> <script async src="https://www.googletagmanager.com/gtag/js?id=G-SZ2C67981H"></script> <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-SZ2C67981H');
    </script> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content='IE=edge;chrome=1'/> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=canonical href=https://kevinjalbert.com/more-shell-history/> <title>More Shell History | Kevin Jalbert</title> <meta name=description content="Developers who use the terminal on a daily basis have a wealth of knowledge stored in their shell's history. It is not uncommon to need a lengthy command you used a while back. Thankfully shells pr..."/> <meta name=keywords content="shell, terminal"/> <meta name=datePublished content="2016-06-30 00:00:00 UTC"/> <meta property="og:article:published_time" content="2016-06-30 00:00:00 UTC"/> <meta name=author content="Kevin Jalbert"/> <meta property="og:article:author" content="2016-06-30 00:00:00 UTC"/> <meta name=url content="https://kevinjalbert.com/more-shell-history/"/> <meta property="og:url" content="https://kevinjalbert.com/more-shell-history/"/> <meta name=site content="Kevin Jalbert"/> <meta property="og:site_name" content="Kevin Jalbert"/> <meta name="twitter:card" content=summary_large_image /> <meta name="twitter:creator" content="@kevinjalbert"/> <meta name="twitter:description" content="Developers who use the terminal on a daily basis have a wealth of knowledge stored in their shell's history. It is not uncommon to need a lengthy command you used a while back. Thankfully shells provide a built in history and the functionality to _reverse search_ through it via ctrl-r."/> <meta name="twitter:image:src" content="https://kevinjalbert.com/images/kevin-jalbert.jpg"/> <meta name="twitter:site" content="Kevin Jalbert"/> <meta name="twitter:title" content="More Shell History"/> <meta property="og:description" content="Developers who use the terminal on a daily basis have a wealth of knowledge stored in their shell's history. It is not uncommon to need a lengthy command you used a while back. Thankfully shells provide a built in history and the functionality to _reverse search_ through it via ctrl-r."/> <meta property="og:image" content="https://kevinjalbert.com/images/kevin-jalbert.jpg"/> <meta property="og:title" content="More Shell History"/> <script type="application/ld+json">
    {
       "@context": "http://schema.org",
       "@type": "BlogPosting",
       "headline": "More Shell History",
       "keywords": "shell, terminal",
       "url": "https://kevinjalbert.com/more-shell-history/",
       "datePublished": "2016-06-30 00:00:00 UTC",
       "dateModified": "2016-06-30 00:00:00 UTC",
       "author": {
         "@type": "Person",
         "name": "Kevin Jalbert",
         "sameAs": [
           "https://twitter.com/kevinjalbert",
           "https://github.com/kevinjalbert",
           "https://keybase.io/kevinjalbert",
           "https://reddit.com/user/kevinjalbert"
         ]
       },
       "mainEntityOfPage": {
          "@type": "WebPage",
         "@id": "https://kevinjalbert.com/more-shell-history/"
       }
    }
  </script> <link href="/stylesheets/app.css" rel=stylesheet /> <link rel=alternate type="application/atom+xml" title="Articles | Kevin Jalbert" href="/feed.xml"/> </head> <div class=container> <div class=header> <div class="col-xs-12 col-sm-7 navigation"> <a class=banner href="/">Kevin Jalbert</a> <a href="/about/">About</a> <a href="/now/">Now</a> <a href="/uses/">Uses</a> <a href="https://github.com/kevinjalbert/ama/blob/master/README.md">AMA</a> </div> <div class="col-xs-12 col-sm-5 search-component"> <input placeholder=Search class="search ui-autocomplete-input ui-corner-all" autocomplete=on> </div> </div> </div> <body> <div class="container content article"> <div class=row> <div class=col-md-12> <h1 class=article__title><p>More Shell History</p> </h1> <div class="row article__meta-info"> <div class="col-xs-4 col-md-4"> <div class="article__date entry-date">June 30, 2016 </div> </div> <div class="col-xs-4 col-md-4"> <div class=article__read-time>2 min read</div> </div> <div class="col-xs-4 col-md-4"> <div class=article__comments> <a href="https://kevinjalbert.com/more-shell-history/#disqus_thread">0 Comments</a> </div> </div> </div> <div class="row article__meta-tags"> <div class="col-xs-12 col-md-12"> <div class=article__tags> <a href="/tags/shell/">shell</a> <a href="/tags/terminal/">terminal</a> </div> </div> </div> <div class=article__separator></div> <div class=newsletter__form> <div class="panel panel-default"> <div class=panel-heading> <h4 class="panel-title accordion-toggle collapsed" data-toggle=collapse data-parent="#accordion" href="#newsletterFormCollapse"> If you enjoy this, consider subscribing to my newsletter </h4> </div> <div id=newsletterFormCollapse class="panel-collapse collapse"> <div class=panel-body> <p style="text-align: center">I aim to publish one article a month</p> <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel=stylesheet> <style>
              #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
              /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
                 We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
        </style> <div id=mc_embed_signup> <form action="//kevinjalbert.us14.list-manage.com/subscribe/post?u=fe02783eec556cfc2893fe174&amp;id=aecd14f8e6" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate> <div id=mc_embed_signup_scroll> <input type=email value="" name=EMAIL class=email id=mce-EMAIL placeholder="E-mail address" required> <div style="position: absolute; left: -5000px;" aria-hidden=true><input name=b_fe02783eec556cfc2893fe174_aecd14f8e6 tabindex=-1 value=""></div> <div class=clear><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class=button></div> </div> </form> </div> </div> </div> </div> </div> <p>Developers who use the terminal on a daily basis have a wealth of knowledge stored in their shell&rsquo;s history. It is not uncommon to need a lengthy command you used a while back. Thankfully shells provide a built in history and the functionality to <em>reverse search</em> through it via <code>ctrl-r</code>.</p> <h1>Increasing History</h1> <p>First thing regardless of what shell try these commands and make note of their values:</p> <div class=highlight><pre class="highlight shell"><code><span class="nb">echo</span> <span class="nv">$HISTSIZE</span>
<span class="nb">echo</span> <span class="nv">$SAVEHIST</span> <span class="c"># or $HISTFILESIZE for bash</span>
<span class="nb">echo</span> <span class="nv">$HISTFILE</span>
</code></pre></div> <p>Across both zsh and bash these three environment variables determine the location and size of your shell history (<a href="http://zsh.sourceforge.net/Guide/zshguide02.html#l17">zsh guide on setting history up</a>):</p> <ul> <li><code>HISTSIZE</code> indicates how many commands from your history file are loaded into the shell&rsquo;s memory</li> <li><code>SAVEHIST</code>/<code>HISTFILESIZE</code> indicates how many commands your history file can hold (you want this equal or larger than <code>HISTSIZE</code>)</li> <li><code>HISTFILE</code> indicates the history file itself which houses your previous commands</li> </ul> <p>Its possible you might have already set some configurations related to the shell&rsquo;s history, or maybe a plugin has set it for you like <a href="https://github.com/robbyrussell/oh-my-zsh/blob/master/lib/history.zsh#L2-L7">oh-my-zsh</a>. You should be aware of your history file and its size at the very least. This would also be a great opportunity to change it if you have not yet.</p> <p>In the default zsh configuration only <code>HISTSIZE</code> is set, and it is tiny at only 30. No history file it set, which means no history is persisted. Default bash configuration has defaults history file and sizes of 500. Both of these are both small with respect to the amount of commands one might use.</p> <p>Recall that the effective reverse search (<code>ctrl-r</code>) is based off of what is in your history. You don&rsquo;t really want to lose anything right? So set something high!</p> <div class=highlight><pre class="highlight shell"><code><span class="c"># In your ~/.bashrc</span>
<span class="nb">export </span><span class="nv">HISTSIZE</span><span class="o">=</span>100000
<span class="nb">export </span><span class="nv">HISTFILESIZE</span><span class="o">=</span>100000

<span class="c"># In your ~/.zshrc</span>
<span class="nb">export </span><span class="nv">HISTSIZE</span><span class="o">=</span>100000
<span class="nb">export </span><span class="nv">HISTFILESIZE</span><span class="o">=</span>100000
<span class="nb">export </span><span class="nv">HISTFILE</span><span class="o">=</span>~/.zhistory <span class="c"># Don't forget to to set this also</span>
</code></pre></div> <p>From what I&rsquo;ve witnessed the major downside to a large history is pretty negligible. When the shell starts it&rsquo;ll read in your history file and store an amount defined by <code>$HISTSIZE</code> in memory. More history simply means slower shell startup, although it is not that significant. In addition there might be some shell plugins which reach into your history, these can also cause slow downs (i.e., <a href="https://github.com/zsh-users/zsh-history-substring-search">zsh-history-substring-search</a> significantly slows down with a large history).</p> <h1>Cleaning History</h1> <p>Now we have a larger history, which by itself is a huge win. Now we want a <em>cleaner</em> history if possible. The main benefit of a cleaner history is that stepping through your history with UP and DOWN keys will not show duplicates.</p> <div class=highlight><pre class="highlight shell"><code><span class="c"># In your ~/.bashrc</span>
<span class="nb">export </span><span class="nv">HISTCONTROL</span><span class="o">=</span>ignoredups

<span class="c"># In your ~/.zshrc</span>
setopt HIST_FIND_NO_DUPS
</code></pre></div> <p>If you wanted you could go even further and actually prevent duplicates from being saved in your history file with the following:</p> <div class=highlight><pre class="highlight shell"><code><span class="c"># In your ~/.bashrc</span>
<span class="nb">export </span><span class="nv">HISTCONTROL</span><span class="o">=</span>erasedups

<span class="c"># In your ~/.zshrc</span>
setopt HIST_IGNORE_ALL_DUPS
</code></pre></div> <h1>Sharing History</h1> <p>If you end up using multiple shells at a time (i.e., opening multiple zsh or bash), you might want to <em>share history</em> between them. By default the history files are written when the shell closes. With the following you can allow the shells to write and read from the history file after each command:</p> <div class=highlight><pre class="highlight shell"><code><span class="c"># In your ~/.bashrc</span>
<span class="nb">shopt</span> <span class="nt">-s</span> histappend
<span class="nb">export </span><span class="nv">PROMPT_COMMAND</span><span class="o">=</span><span class="s2">"history -a; history -c; history -r; </span><span class="nv">$PROMPT_COMMAND</span><span class="s2">"</span>

<span class="c"># In your ~/.zshrc</span>
setopt inc_append_history
setopt share_history
</code></pre></div> <h1>Putting it Together &ndash; TL;DR</h1> <p>If you want more history use the following:</p> <div class=highlight><pre class="highlight shell"><code><span class="c"># In your ~/.bashrc</span>
<span class="nb">export </span><span class="nv">HISTSIZE</span><span class="o">=</span>100000
<span class="nb">export </span><span class="nv">HISTFILESIZE</span><span class="o">=</span>100000

<span class="nb">export </span><span class="nv">HISTCONTROL</span><span class="o">=</span>ignoredups

<span class="nb">shopt</span> <span class="nt">-s</span> histappend
<span class="nb">export </span><span class="nv">PROMPT_COMMAND</span><span class="o">=</span><span class="s2">"history -a; history -c; history -r; </span><span class="nv">$PROMPT_COMMAND</span><span class="s2">"</span>

<span class="c"># In your ~/.zshrc</span>
<span class="nb">export </span><span class="nv">HISTSIZE</span><span class="o">=</span>100000
<span class="nb">export </span><span class="nv">HISTFILESIZE</span><span class="o">=</span>100000
<span class="nb">export </span><span class="nv">HISTFILE</span><span class="o">=</span>~/.zhistory

setopt HIST_FIND_NO_DUPS

setopt inc_append_history
setopt share_history
</code></pre></div> <div class=article__comments-button><button type=button class="btn btn-default show-comments">Click to Disqus</button></div> <div id=disqus_thread></div> </div> </div> </div> <script>
//<![CDATA[
    var disqus_shortname = 'kevinjalbert';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
//]]>
</script> </body> <div class="container footer"> <div class="col-md-12 footer__social"> <a href="https://twitter.com/KevinJalbert">Twitter</a> <a href="https://github.com/kevinjalbert">GitHub</a> <a href="https://stackoverflow.com/users/583592/kevin-jalbert">Stack Overflow</a> </div> <div class="col-md-12 footer__copywrite"> Code licensed <a href="https://github.com/kevinjalbert/kevinjalbert.github.io/blob/real-master/LICENSE">MIT</a>, Content &copy; 2019 Kevin Jalbert </div> </div> </html> <script src="/javascripts/app.js"></script>